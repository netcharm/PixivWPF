<Page x:Class="PixivWPF.Pages.IllustDetailPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
      xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
      xmlns:local="clr-namespace:PixivWPF.Pages"
      xmlns:Common="clr-namespace:PixivWPF.Common"
      xmlns:interop="clr-namespace:Microsoft.DwayneNeed.Interop;assembly=Microsoft.DwayneNeed"
      mc:Ignorable="d" 
      d:DesignHeight="600" d:DesignWidth="300"
      VisualTextRenderingMode="Auto"
      RenderOptions.BitmapScalingMode="HighQuality"
      RenderOptions.CachingHint="Cache"
      RenderOptions.ClearTypeHint="Enabled"
      RenderOptions.EdgeMode="Aliased"
      TextOptions.TextFormattingMode="Display"
      AllowDrop="True"
      Title="IllustDetailPage"
      PreviewMouseDown="Page_PreviewMouseDown"
      Loaded="Page_Loaded" Unloaded="Page_Unloaded">

    <Page.Resources>
        <ContextMenu x:Key="ActionBookmarkIllust">
            <MenuItem x:Uid="ActionBookmarkIllustPublic" Header="Public" Click="ActionBookmarkIllust_Click" >
                <MenuItem.Icon>
                    <iconPacks:PackIconModern Kind="Heart" Foreground="{DynamicResource MahApps.Brushes.Accent}" Width="22" Height="22" Margin="4,0,0,0"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionBookmarkIllustPrivate" Header="Private" Click="ActionBookmarkIllust_Click">
                <MenuItem.Icon>
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="4,0,0,0">
                        <iconPacks:PackIconModern 
                                                    Kind="Heart" Width="22" Height="22" 
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
                        <iconPacks:PackIconModern 
                                                    Kind="Lock" Width="8" Height="8"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"/>
                    </Grid>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem x:Uid="ActionBookmarkIllustRemove" Header="Remove" Click="ActionBookmarkIllust_Click">
                <MenuItem.Icon>
                    <iconPacks:PackIconModern Kind="HeartOutline" Foreground="{DynamicResource MahApps.Brushes.Accent}" Width="22" Height="22"  Margin="4,0,0,0"/>
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>

        <ContextMenu x:Key="ActionFollowAuthor">
            <MenuItem x:Uid="ActionFollowAuthorPublic" Header="Public" Click="ActionFollowAuthor_Click">
                <MenuItem.Icon>
                    <iconPacks:PackIconModern Kind="Star" Foreground="{DynamicResource MahApps.Brushes.Accent}" Width="22" Height="22" Margin="4,0,0,0"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionFollowAuthorPrivate" Header="Private" Click="ActionFollowAuthor_Click">
                <MenuItem.Icon>
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="4,0,0,0">
                        <iconPacks:PackIconModern 
                                                    Kind="Star" Width="22" Height="22" 
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
                        <iconPacks:PackIconModern 
                                                    Kind="Lock" Width="8" Height="8"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                                    Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"/>
                    </Grid>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem x:Uid="ActionFollowAuthorRemove" Header="Remove" Click="ActionFollowAuthor_Click">
                <MenuItem.Icon>
                    <TextBlock Text="&#xE1CE;" FontSize="22" FontFamily="Segoe MDL2 Assets"                                                
                                                Foreground="{DynamicResource MahApps.Brushes.Accent}"
                                                HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>

        <ContextMenu x:Key="ActionIllust" Opened="DownloadAction_Opened">
            <MenuItem x:Uid="ActionIllustNewWindow" Header="Open Illust in New Window" Click="ActionIllustInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE8A7;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionIllustWebPage" Header="Open Illust in Browser" Click="ActionIllustInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xF6FA;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionIllustWebLink" Header="Copy Illust Weblink" Click="ActionIllustInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE167;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionSendIllustToInstance" Header="Send Illust To Other Instance" Click="ActionIllustInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE724;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator />
            <MenuItem x:Uid="ActionAuthorInfo" Header="Open Author Detail" Click="ActionAuthourInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE136;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionAuthorWebPage" Header="Open Author in Browser" Click="ActionAuthourInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xF6FA;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionAuthorWebLink" Header="Copy Author Weblink" Click="ActionAuthourInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE167;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionSendAuthorToInstance" Header="Send Author To Other Instance" Click="ActionAuthourInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE725;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator />
            <MenuItem x:Uid="ActionCopyIllustTitle" Header="Copy Illust Title" Click="ActionIllustInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionCopyAuthor" Header="Copy Author Name" Click="ActionAuthourInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionCopyIllustID" Header="Copy Illust ID" Click="ActionIllustInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionCopyAuthorID" Header="Copy Author ID" Click="ActionAuthourInfo_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionCopyIllustDate" Header="Illust Date" Click="ActionIllustInfo_Click" ToolTip="Click to copy illust date">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEC92;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionCopyIllustJson" Header="Copy Illust As JSON/XML" Click="ActionIllustInfo_Click" ToolTip="Click to copy illust info as JSON/XML">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>            
            <Separator />
            <MenuItem x:Uid="ActionIllustPages" Header="Show Illust Pages" Click="ActionShowIllustPages_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE155;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionIllustRelated" Header="Show Related Illusts" Click="ActionShowRelated_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE155;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionIllustFavorite" Header="Show Favorite Illusts" Click="ActionShowFavorite_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE155;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem x:Uid="ActionCompare" Header="Compare Selected"  Click="ActionCompare_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionRefreshIllust" Header="Refresh Illust" Click="ActionRefresh_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator />
            <MenuItem x:Uid="ActionsSave" Header="Save Actions ...">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
                <MenuItem x:Uid="ActionSaveIllust" Header="Save Selected Illust Page" Click="ActionSaveIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustAll" Header="Save All Illust Pages" Click="ActionSaveAllIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustJpeg" Header="Save Illust Page As JPEG" Click="ActionSaveIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustJpegAll" Header="Save All Illust Pages As JPEG" Click="ActionSaveAllIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                         Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustPreview" Header="Save Illust Page Large Preview" Click="ActionSaveIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustPreviewAll" Header="Save All Illust Pages Large Preview" Click="ActionSaveAllIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                         Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <Separator x:Uid="ActionConvertIllustJpegSep"/>
            <MenuItem x:Uid="ActionConvertIllustJpeg" Header="Convert Downloaded To JPEG" Click="ActionSaveIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionConvertIllustJpegAll" Header="Convert All Downloaded To JPEG" Click="ActionSaveAllIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                         Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReduceIllustJpeg" Header="Reduce Downloaded JPEG Size" Click="ActionSaveIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReduceIllustJpegAll" Header="Reduce All Downloaded JPEG Size" Click="ActionSaveAllIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator x:Uid="SepratorUgoira"/>
            <MenuItem x:Uid="ActionSavePreviewUgoiraFile" Header="Save Preview Ugoira File" Click="ActionUgoiraGet_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE173;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionSaveOriginalUgoiraFile" Header="Save Original Ugoira File" Click="ActionUgoiraGet_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE173;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionOpenUgoiraFile" Header="Open Ugoira File" Click="ActionUgoiraGet_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE173;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>            
        </ContextMenu>

        <ContextMenu x:Name="DownloadAction" x:Key="DownloadAction" Opened="DownloadAction_Opened">
            <MenuItem x:Uid="ActionSaveIllust" Header="Save Illust" Click="ActionSaveIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionSaveIllustJpeg" Header="Save Illust Page As JPEG" Click="ActionSaveIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionSaveIllustPreview" Header="Save Illust Page Large Preview" Click="ActionSaveIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator x:Uid="ActionConvertIllustJpegSep"/>
            <MenuItem x:Uid="ActionConvertIllustJpeg" Header="Convert Downloaded To JPEG" Click="ActionSaveIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReduceIllustJpeg" Header="Reduce Downloaded JPEG Size" Click="ActionSaveIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReduceJpegSizeTo" Header="Quality To" Click="ActionSaveIllust_Click" 
                      Template="{DynamicResource MenuItemWithSlider}" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator x:Uid="ActionDownloadedSep"/>
            <MenuItem x:Uid="ActionCompareDownloaded" Header="Compare Downloaded"  Click="ActionOpenIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionShowDownloadedMeta" Header="Show Downloaded Metadata" Click="ActionOpenIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE114;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionTouchDownloadedMeta" Header="Touch Downloaded Metadata" Click="ActionOpenIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE114;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionOpenDownloaded" Header="Open Downloaded Illust" Click="ActionOpenIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE118;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionOpenDownloadedProperties" Header="View Downloaded Properties" Click="ActionOpenIllust_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEA1F;" FontSize="16" FontFamily="Segoe MDL2 Assets"                                            
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>

        <ContextMenu x:Name="MenuGallaryAction" x:Key="MenuGallaryAction" Opened="MenuGallaryAction_Opened">
            <MenuItem x:Uid="ActionCopyIllustID" Header="Copy Illust ID" Click="ActionCopyIllustID_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionIllustWebLink" Header="Copy Illust Weblink" Click="ActionCopyWeblink_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE167;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionAuthorWebLink" Header="Copy Author Weblink" Click="ActionCopyWeblink_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE167;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionCopyIllustJson" Header="Copy Illust As JSON/XML" Click="ActionCopyIllustInfo_Click" ToolTip="Click to copy illust info as JSON/XML">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionOpenIllust" Header="Open Selected Illusts" Click="ActionOpenSelected_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE8A7;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReadIllustTitle" Header="Read Selected Illusts Title" Click="ActionSpeech_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEFA9;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator x:Name="ActionSendSeparator" x:Uid="ActionSendSeparator"/>
            <MenuItem x:Uid="ActionSendIllustToInstance" Header="Send Illust To Other Instance" Click="ActionSendToOtherInstance_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE724;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionSendAuthorToInstance" Header="Send Author To Other Instance" Click="ActionSendToOtherInstance_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE725;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionCompare" Header="Compare Selected"  Click="ActionCompare_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator x:Name="ActionRefreshSeparator" x:Uid="ActionRefreshSeparator"/>
            <MenuItem x:Uid="ActionRefresh" Header="Refresh Illusts" Click="ActionRefreshIllusts_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE117;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionRefreshThumb" Header="Refresh Thumbnails" Click="ActionRefreshIllusts_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator x:Name="ActionNavPageSeparator" x:Uid="ActionNavPageSeparator"/>
            <MenuItem x:Uid="ActionPrevPage" Header="Open Previous Page" Click="ActionPrevPage_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE112;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="ActionNextPage" x:Uid="ActionNextPage" Header="Open Next Page" Click="ActionNextPage_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE111;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionNextAppend" Header="Append Next Page" Click="ActionNextPage_Click" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEB91;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator x:Name="ActionLikeIllustSeparator" x:Uid="ActionLikeIllustSeparator" />
            <MenuItem x:Uid="ActionsLikeIllust" Header="Bookmark Actions ...">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEB52;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
                <MenuItem x:Uid="ActionLikeIllust" Header="Bookmark Selected" Click="ActionBookmarkIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEB52;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionLikeIllustPrivate" Header="Bookmark Selected Private" Click="ActionBookmarkIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEB52;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionUnLikeIllust" Header="Un-Bookmark Selected" Click="ActionBookmarkIllust_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEA92;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <Separator x:Name="ActionLikeUserSeparator" x:Uid="ActionLikeUserSeparator" />
            <MenuItem x:Uid="ActionsLikeUser" Header="Follow Actions ...">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE113;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
                <MenuItem x:Name="ActionLikeUser" x:Uid="ActionLikeUser" Header="Follow Selected" Click="ActionFollowAuthor_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE113;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionLikeUserPrivate" Header="Follow Selected Private" Click="ActionFollowAuthor_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE113;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionUnLikeUser" Header="Un-Follow Selected" Click="ActionFollowAuthor_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE734;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <Separator x:Name="ActionSaveSeparator" x:Uid="ActionSaveSeparator"/>
            <MenuItem x:Uid="ActionsSave" Header="Save Actions ...">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                           Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
                <MenuItem x:Uid="ActionSaveIllusts" Header="Save Selected Illusts (Default Page)" Click="ActionSaveIllusts_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustsAll" Header="Save Selected Illusts (All Pages)" Click="ActionSaveIllustsAll_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustsJpeg" Header="Save Illust Page As JPEG" Click="ActionSaveIllusts_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustsJpegAll" Header="Save All Illust Pages As JPEG" Click="ActionSaveIllustsAll_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                             Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustsPreview" Header="Save Illust Page Large Preview" Click="ActionSaveIllusts_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Uid="ActionSaveIllustsPreviewAll" Header="Save All Illust Pages Large Preview" Click="ActionSaveIllustsAll_Click">
                    <MenuItem.Icon>
                        <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                             Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <Separator x:Name="ActionMetaSeparator" x:Uid="ActionMetaSeparator"/>
            <MenuItem x:Uid="ActionConvertIllustsJpeg" Header="Convert Downloaded To JPEG" Click="ActionSaveIllusts_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionConvertIllustsJpegAll" Header="Convert All Downloaded To JPEG" Click="ActionSaveIllustsAll_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                         Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReduceIllustsJpeg" Header="Reduce Downloaded JPEG Size" Click="ActionSaveIllusts_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReduceIllustsJpegSizeTo" Header="Quality To" Click="ActionSaveIllusts_Click" 
                      Template="{DynamicResource MenuItemWithSlider}" >
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionReduceIllustsJpegAll" Header="Reduce All Downloaded JPEG Size" Click="ActionSaveIllustsAll_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEA35;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem x:Uid="ActionCompareDownloaded" Header="Compare Downloaded"  Click="ActionCompare_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                               Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionShowDownloadedMeta" Header="Show Downloaded Metadata" Click="ActionOpenDownloaded_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE114;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionTouchDownloadedMeta" Header="Touch Downloaded Metadata" Click="ActionOpenDownloaded_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE114;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionOpenDownloaded" Header="Open Downloaded Illusts" Click="ActionOpenDownloaded_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xE118;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Uid="ActionOpenDownloadedProperties" Header="View Downloaded Properties" Click="ActionOpenDownloaded_Click">
                <MenuItem.Icon>
                    <TextBlock Margin="4,0,0,0" Text="&#xEA1F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>
       
        <ContextMenu x:Name="MenuSpeech" x:Key="MenuSpeech">
            <MenuItem x:Name="miSpeechAuto" x:Uid="SpeechAuto" Header="Auto Detect" Click="ActionSpeech_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE164;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem x:Name="miSpeechChineseS" x:Uid="SpeechChineseS" Header="ChineseS" Click="ActionSpeech_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE88D;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="miSpeechChineseT" x:Uid="SpeechChineseT" Header="ChineseT" Click="ActionSpeech_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE88C;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="miSpeechJapaness" x:Uid="SpeechJapaness" Header="Japanese" Click="ActionSpeech_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE986;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="miSpeechKorean" x:Uid="SpeechKorean" Header="Korean" Click="ActionSpeech_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE97D;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="miSpeechEnglish" x:Uid="SpeechEnglish" Header="English" Click="ActionSpeech_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE97E;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem x:Name="miCopyText" x:Uid="CopyText" Header="Copy Selected" ToolTip="Copy Selected To Clipboard" Click="ActionCopySelectedText_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="miSendToInstance" x:Uid="SendToInstance" Header="Send Selected" ToolTip="Send Selected To Other Instance" Click="ActionSendToInstance_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE724;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="miSearchTextInFiles" x:Uid="SearchTextInFiles" Header="Search In Files" ToolTip="Search Selected In Downloaded" Click="ActionSearchSelectedText_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE773;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem x:Name="miSearchTextInWeb" x:Uid="SearchTextInWeb" Header="Search In Web" ToolTip="Search Selected In Web" Click="ActionSearchSelectedText_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xEDE4;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem x:Name="miRefresh" x:Uid="Refresh" Header="Refresh" ToolTip="Refresh It!" Click="ActionRefresh_Click" >
                <MenuItem.Icon>
                    <TextBlock Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.Accent}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>

        <CubicEase  x:Key="CubicEaseOut" EasingMode="EaseOut" />
        <Style x:Key="PreviewPopupTrigger" TargetType="{x:Type Popup}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="true">
                    <Setter Property="Cursor" Value="Hand"/>
                </Trigger>
                <Trigger Property="IsOpen" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation
                                    Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                    From="1" To="1.5" Duration="0:0:1" 
                                    EasingFunction="{StaticResource CubicEaseOut}"/>
                                <DoubleAnimation
                                    Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                    From="1" To="1.5" Duration="0:0:1" 
                                    EasingFunction="{StaticResource CubicEaseOut}"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Popup x:Name="PreviewPopup" x:Uid="PreviewPopup" x:Key="PreviewPopup" 
               Placement="MousePoint" StaysOpen="False" AllowsTransparency="True" 
               HorizontalOffset="78" VerticalOffset="-64" 
               Margin="4" HorizontalAlignment="Center" VerticalAlignment="Center"
               Style="{StaticResource PreviewPopupTrigger}"
               Opened="PreviewPopup_Opened" Closed="PreviewPopup_Closed"
               MouseEnter="PreviewPopup_MouseEnter" MouseLeave="PreviewPopup_MouseLeave"
               PreviewMouseDown="Page_PreviewMouseDown">
            <Grid x:Name="PopupContainer" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <!-- Background -->
                <Rectangle Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="0" Grid.RowSpan="3" 
                           Opacity="0.25"
                           Stroke="{DynamicResource MahApps.Brushes.Accent}"
                           Fill="{DynamicResource MahApps.Brushes.Menu.Background}"/>
                <!-- Tool Buttons -->
                <Button Grid.Column="0" Grid.Row="0" Margin="4" ToolTip="Copy Illust ID"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE16F;" FontSize="24" FontFamily="Segoe MDL2 Assets"                         
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
                <Button Grid.Column="2" Grid.Row="0" Margin="4" ToolTip="Copy Preview"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE295;" FontSize="24" FontFamily="Segoe MDL2 Assets"                         
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
                <Button Grid.Column="0" Grid.Row="2" Margin="4" ToolTip="Send Illust To Other Instance"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE724;" FontSize="24" FontFamily="Segoe MDL2 Assets"                         
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
                <Button Grid.Column="2" Grid.Row="2" Margin="4" ToolTip="Send Author To Other Instance"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE725;" FontSize="24" FontFamily="Segoe MDL2 Assets"                         
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
                <Button Grid.Column="0" Grid.Row="1" Margin="4" ToolTip="Refresh Preview"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE149;" FontSize="24" FontFamily="Segoe MDL2 Assets"                         
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
                <Button Grid.Column="1" Grid.Row="1" Margin="4" ToolTip="Open Preview Window"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE91B;" FontSize="24" FontFamily="Segoe MDL2 Assets"                            
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}" />
                </Button>
                <Button Grid.Column="2" Grid.Row="1" Margin="4" ToolTip="Open Preview With..."
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xEB9F;" FontSize="24" FontFamily="Segoe MDL2 Assets"
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
                <Button Grid.Column="1" Grid.Row="2" Margin="4" ToolTip="Save Illust"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE105;" FontSize="24" FontFamily="Segoe MDL2 Assets"                         
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
                <Button Grid.Column="1" Grid.Row="0" Margin="4" ToolTip="Open Downloaded Illust"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}"
                        Background="Transparent" Click="PreviewPopup_Click">
                    <TextBlock Text="&#xE118;" FontSize="24" FontFamily="Segoe MDL2 Assets"                         
                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                        HorizontalAlignment="Center" VerticalAlignment="Center" Effect="{DynamicResource DropGlow}"/>
                </Button>
            </Grid>
        </Popup>
    </Page.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition MinWidth="710"/>
        </Grid.ColumnDefinitions>

        <!-- Illust Detail Viewport -->
        <ScrollViewer Grid.Column="0" x:Name="IllustDetailViewer"
                      Margin="4,4,4,4"
                      HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                      HorizontalContentAlignment="Stretch" VerticalContentAlignment="Top"
                      VerticalScrollBarVisibility="Auto">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <!-- Illust Preview -->
                <Grid Grid.Row="0" x:Name="PreviewViewer" Width="Auto" Height="Auto" MinHeight="144" Visibility="Collapsed">
                    <Grid.Resources>
                        <ControlTemplate x:Key="SanityMarkTemplate">
                            <Grid x:Name="SanityMark" Opacity="0.33" Margin="4,0,0,4" Effect="{DynamicResource DropGlow}">
                                <TextBlock x:Name="SanityMarkText" 
                                    FontSize="{Binding FontSize, ElementName=SanityMarkSign, Converter={mah:MathMultiplyConverter}, ConverterParameter='0.5'}" 
                                    FontWeight="SemiBold" Padding="0,0,4,0"                                           
                                    Text="{Binding Text, Mode=OneWay, ElementName=IllustSanity}" 
                                    LayoutTransform="{DynamicResource FontStretchSemiCondensed}"
                                    Foreground="{Binding Foreground, Mode=OneWay, ElementName=IllustSanity}"
                                    HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                <TextBlock x:Name="SanityMarkSign" Text="&#xF140;"
                                    FontSize="64pt" FontWeight="SemiBold" FontFamily="Segoe MDL2 Assets"
                                    Foreground="{DynamicResource MahApps.Brushes.SystemControlErrorTextForeground}"
                                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                            </Grid>
                        </ControlTemplate>
                    </Grid.Resources>
                    <Grid.Background>
                        <ImageBrush ImageSource="pack://application:,,,/PixivWPF;component/Resources/CheckboardPattern_32.png" 
                            TileMode="Tile"  Opacity="0.10" ViewportUnits="Absolute" Viewport="0,0,32,32"/>
                    </Grid.Background>
                    <Viewbox x:Name="PreviewViewbox" StretchDirection="DownOnly">
                        <Image x:Name="Preview" x:Uid="Preview" Stretch="None" 
                               HorizontalAlignment="Center" VerticalAlignment="Center" SnapsToDevicePixels="True" />
                    </Viewbox>
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="0"
                        Visibility="{Binding Visibility, Mode=OneWay, ElementName=IllustSanityInfo}">
                        <ContentControl Template="{DynamicResource SanityMarkTemplate}" HorizontalAlignment="Left" VerticalAlignment="Top" />
                        <ContentControl Template="{DynamicResource SanityMarkTemplate}" HorizontalAlignment="Right" VerticalAlignment="Top" />
                        <ContentControl Template="{DynamicResource SanityMarkTemplate}" HorizontalAlignment="Left" VerticalAlignment="Bottom" />
                        <ContentControl Template="{DynamicResource SanityMarkTemplate}" HorizontalAlignment="Right" VerticalAlignment="Bottom" />
                    </Grid>
                    <ContentControl Grid.Row="0" x:Name="PreviewBox">
                        <ContentControl.ContextMenu>
                            <ContextMenu Opened="DownloadAction_Opened">
                                <MenuItem x:Name="PreviewCopyIllustID" x:Uid="ActionCopyIllustID" Header="Copy Illust ID" Visibility="Visible" Click="ActionIllustInfo_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewCopyImage" x:Uid="ActionCopyImage" Header="Copy Preview" Visibility="Visible" Click="ActionIllustInfo_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE295;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewCopyIllustJson" x:Uid="ActionCopyIllustJson" Header="Copy Illust Info as JSON/XML" Click="ActionIllustInfo_Click" ToolTip="Click to copy illust JSON">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE16F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem x:Name="PreviewSendIllustToInstance" x:Uid="ActionSendIllustToInstance" Header="Send Illust To Other Instance" Click="ActionSendToOtherInstance_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE724;" FontSize="16" FontFamily="Segoe MDL2 Assets"             
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewSendAuthorToInstance" x:Uid="ActionSendAuthorToInstance" Header="Send Author To Other Instance" Click="ActionSendToOtherInstance_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE725;" FontSize="16" FontFamily="Segoe MDL2 Assets"                         
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewCompare" x:Uid="ActionCompare" Header="Compare Selected"  Click="ActionCompare_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem x:Name="PreviewRefresh" x:Uid="ActionRefreshPreview" Header="Refresh Preview" Click="ActionRefreshPreview_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets"  
                                             Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewOpen" x:Uid="ActionOpenIllust" Header="Open Preview Window" Click="ActionOpenIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE91B;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewCacheOpen" x:Uid="ActionOpenPreview" Header="Open Preview With..." Click="ActionOpenIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xEB9F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem x:Name="PreviewSave" x:Uid="ActionSaveIllust" Header="Save Illust" Click="ActionSaveIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Uid="ActionSaveIllustJpeg" Header="Save Illust Page As JPEG" Click="ActionSaveIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Uid="ActionSaveIllustPreview" Header="Save Illust Page Large Preview" Click="ActionSaveIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Uid="ActionConvertIllustJpegSep"/>
                                <MenuItem x:Uid="ActionConvertIllustJpeg" Header="Convert Downloaded To JPEG" Click="ActionSaveIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Uid="ActionReduceIllustJpeg" Header="Reduce Downloaded JPEG Size" Click="ActionSaveIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE105;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Uid="ActionDownloadedSep"/>
                                <MenuItem x:Name="ActionShowDownloadedMeta" x:Uid="ActionShowDownloadedMeta" Header="Show Downloaded Metadata" Click="ActionOpenIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE114;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="ActionTouchDownloadedMeta" x:Uid="ActionTouchDownloadedMeta" Header="Touch Downloaded Metadata" Click="ActionOpenIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE114;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewOpenDownloaded" x:Uid="ActionOpenDownloaded" Header="Open Downloaded Illust" Click="ActionOpenIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xE118;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="PreviewOpenDownloadedProperties" x:Uid="ActionOpenDownloadedProperties" Header="View Downloaded Properties" Click="ActionOpenIllust_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Margin="4,0,0,0" Text="&#xEA1F;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                            Foreground="{DynamicResource MahApps.Brushes.Accent}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </ContentControl.ContextMenu>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width=".25*" />
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width=".25*" />
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" x:Name="btnSubPagePrev" x:Uid="btnSubPagePrev"
                                Width="auto" Visibility="Collapsed" MinWidth="32"
                                HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                                HorizontalContentAlignment="Left" VerticalContentAlignment="Center"
                                Background="Transparent" Foreground="{DynamicResource MahApps.Brushes.Accent}" 
                                BorderThickness="0" BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
                                Click="SubPageNav_Clicked">
                                <Button.Content>
                                    <TextBlock Margin="4,0,0,0" HorizontalAlignment="Center" VerticalAlignment="Center"
                                        Text="&#xE76B;" FontFamily="Segoe MDL2 Assets" Effect="{DynamicResource DropGlow}"
                                        FontSize="{Binding Path=MinWidth, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" 
                                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" />
                                </Button.Content>
                            </Button>
                            <Button Grid.Column="2" x:Name="btnSubPageNext" x:Uid="btnSubPageNext"
                                Width="auto" Visibility="Collapsed" MinWidth="32"
                                HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                                HorizontalContentAlignment="Right" VerticalContentAlignment="Center"
                                Background="Transparent" Foreground="{DynamicResource MahApps.Brushes.Accent}" 
                                BorderThickness="0" BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
                                Click="SubPageNav_Clicked">
                                <Button.Content>
                                    <TextBlock Margin="4,0,0,0" HorizontalAlignment="Center" VerticalAlignment="Center"
                                        Text="&#xE76C;" FontFamily="Segoe MDL2 Assets" Effect="{DynamicResource DropGlow}"
                                        FontSize="{Binding Path=MinWidth, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" 
                                        Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"/>
                                </Button.Content>
                            </Button>
                            <Rectangle Grid.Column="0" Grid.ColumnSpan="3" x:Name="PreviewRect" x:Uid="PreviewRect"
                                HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Fill="Transparent"
                                MouseMove="PreviewRect_MouseMove" MouseLeave="PreviewRect_MouseLeave"
                                MouseLeftButtonDown="PreviewRect_MouseLeftButtonDown"/>
                            <Common:ProgressRingCloud 
                                Grid.Column="1" x:Name="PreviewWait" Size="96" Visibility="Collapsed" 
                                ReloadEnabled="True" ReloadClick="ActionRefreshPreview_Click"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}" Background="Transparent" Opacity="0.75"
                                ShadowColor="{DynamicResource MahApps.Colors.IdealForeground}" ShadowBlurRadius="3" ShadowDepth="1" ShadowOpacity="1"
                                VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Grid>
                    </ContentControl>
                    <mah:Badged Grid.Row="0" x:Name="PreviewBadge" x:Uid="PreviewBadge"
                            Margin="0,0,0,20"  Visibility="Collapsed" Opacity="0.33"
                            BadgeFontFamily="{DynamicResource MonoSpaceFamily}" BadgeFontSize="16"
                            BadgePlacementMode="Bottom" BadgeMargin="8,2" 
                            MouseEnter="PreviewBadge_MouseEnter" MouseLeave="PreviewBadge_MouseLeave" />
                </Grid>

                <!-- Illust Author Info -->
                <Grid Grid.Row="1" Margin="0,8,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="32"/>
                        <RowDefinition Height="32"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="64"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Image Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" x:Name="IllustAuthorAvatar" 
                       Width="64" Height="64" Stretch="Uniform"
                       HorizontalAlignment="Center" VerticalAlignment="Center" />
                    <Button Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" x:Name="btnAuthorAvatar" x:Uid="btnAuthorAvatar"
                            ToolTip="Click to Open User Infomation Window"
                            Width="64" Height="64" BorderThickness="0" BorderBrush="Transparent"
                            Background="Transparent" Foreground="Transparent"
                            Click="ActionAuthourInfo_Click" MouseRightButtonUp="AuthorAvatar_MouseRightButtonUp"/>
                    <Common:ProgressRingCloud 
                        Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" x:Name="AuthorAvatarWait" Size="48" Visibility="Collapsed" 
                        ReloadEnabled="True" ReloadClick="ActionAuthourInfo_Click"
                        Foreground="{DynamicResource MahApps.Brushes.Accent}" Background="Transparent" Opacity="0.75"
                        ShadowColor="{DynamicResource MahApps.Colors.IdealForeground}" ShadowBlurRadius="10" ShadowDepth="1" ShadowOpacity="1"
                        VerticalAlignment="Center" HorizontalAlignment="Center"/>

                    <Grid Grid.Row="0" Grid.Column="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" x:Name="IllustTitle" Margin="4,0,2,0"
                            FontFamily="{StaticResource NormalFamily}"
                            ContextMenu="{DynamicResource MenuSpeech}" 
                            MouseDown="IllustInfo_MouseDown"
                            Foreground="{DynamicResource MahApps.Brushes.Text}"
                            HorizontalAlignment="Left" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                        <Border Grid.Column="1" x:Name="IllustSanityInfo" 
                            Visibility="Collapsed" 
                            ContextMenu="{DynamicResource MenuSpeech}" 
                            BorderBrush="{DynamicResource MahApps.Brushes.SystemControlErrorTextForeground}"
                            CornerRadius="3" BorderThickness="3" Height="20" Width="Auto" Margin="0,0,2,0">
                            <TextBlock x:Name="IllustSanity" Text="18" Margin="1"
                                FontSize="{Binding Height, ElementName=IllustSanityInfo, Converter={mah:MathMultiplyConverter}, ConverterParameter='0.75'}" 
                                FontWeight="SemiBold"
                                Foreground="{DynamicResource MahApps.Brushes.Text}"
                                HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Grid.Column="2" x:Name="IllustAiInfo" Visibility="Collapsed" 
                            Margin="2,-2,2,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                            Text="&#x1F52F;" FontSize="16" FontFamily="Segoe UI Symbol"                                
                            Foreground="{DynamicResource MahApps.Brushes.Accent}" />
                        <StackPanel Grid.Column="3" x:Name="IllustDateInfo" Visibility="Collapsed" MinWidth="24" Margin="2,0,0,0"
                                    ContextMenu="{DynamicResource MenuSpeech}" 
                                    MouseDown="IllustInfo_MouseDown"
                            HorizontalAlignment="Right" VerticalAlignment="Center" Orientation="Horizontal" >
                            <TextBlock x:Name="IllustDateIcon"  Margin="0,2,0,0"
                                Text="&#xE161;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}"
                                HorizontalAlignment="Right" VerticalAlignment="Center"/>                            
                            <TextBlock x:Name="IllustDate" Margin="2,0,4,0" 
                               Foreground="{DynamicResource MahApps.Brushes.Text}"
                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Grid>

                    <Grid Grid.Row="1" Grid.Column="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                            <TextBlock Grid.Column="0" x:Name="IllustAuthor" Margin="4,0,0,0" 
                                FontFamily="{StaticResource NormalFamily}"
                                ContextMenu="{DynamicResource MenuSpeech}" 
                                MouseDown="IllustInfo_MouseDown"
                                Foreground="{DynamicResource MahApps.Brushes.Text}"
                                HorizontalAlignment="Left" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                            <TextBlock Grid.Column="0" x:Name="UserFullListedFlag" Margin="4,0,0,0" Visibility="Collapsed"
                                Text="&#xE129;" FontSize="16"
                                FontFamily="{StaticResource SegoeIconFamily}"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}"
                                HorizontalAlignment="Left" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"
                                MouseLeftButtonUp="UserFullListedFlag_MouseLeftButtonUp"/>
                        </StackPanel>
                        <StackPanel Grid.Column="1" x:Name="IllustStatInfo" Visibility="Collapsed"
                            HorizontalAlignment="Right" VerticalAlignment="Center" Orientation="Horizontal" >
                            <TextBlock x:Name="IllustUgoiraDownloaded" Visibility="Collapsed"
                                Margin="2,0,4,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                Text="&#xE173;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                MouseDown="IllustUgoiraDownloaded_MouseDown"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}" />
                            <TextBlock x:Name="IllustDownloaded" Visibility="Collapsed"
                                Margin="2,0,4,0" HorizontalAlignment="Right" VerticalAlignment="Center"
                                Text="&#xE118;" FontSize="16" FontFamily="Segoe MDL2 Assets" FontWeight="Black"
                                MouseDown="IllustDownloaded_MouseDown"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}" />
                            <TextBlock x:Name="IllustSizeIcon" ContextMenu="{DynamicResource DownloadAction}"
                                Text="&#xE1CA;" FontSize="16" FontFamily="Segoe MDL2 Assets" FontWeight="Black"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}"
                                HorizontalAlignment="Right" VerticalAlignment="Center"
                                PreviewMouseMove="IllustSizeInfo_MouseMove" />
                            <TextBlock x:Name="IllustSize" Margin="2,0,4,0" ContextMenu="{DynamicResource DownloadAction}"
                               Foreground="{DynamicResource MahApps.Brushes.Text}"
                               HorizontalAlignment="Right" VerticalAlignment="Center"
                               PreviewMouseMove="IllustSizeInfo_MouseMove" />
                            <TextBlock x:Name="IllustViewedIcon" 
                                Text="&#xE18B;" FontSize="16" FontFamily="Segoe MDL2 Assets" FontWeight="Black"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}"
                                HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            <TextBlock x:Name="IllustViewed" Margin="2,0,4,0" 
                               Foreground="{DynamicResource MahApps.Brushes.Text}"
                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            <TextBlock x:Name="IllustFavoritedIcon" 
                                Text="&#xEB52;" FontSize="16" FontFamily="Segoe MDL2 Assets"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}"
                                HorizontalAlignment="Right" VerticalAlignment="Center"/>                            
                            <TextBlock x:Name="IllustFavorited" Margin="2,0,4,0" 
                               Foreground="{DynamicResource MahApps.Brushes.Text}"
                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Grid>

                    <StackPanel Grid.Row="0" Grid.RowSpan="2" Grid.Column="2" x:Name="ActionBarInfo"
                                Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <Button x:Name="BookmarkIllust" x:Uid="BookmarkIllust" Click="ActionIllust_Click"
                                ToolTip="Bookmark Illust" Visibility="Collapsed"
                                ContextMenu="{DynamicResource ActionBookmarkIllust}"
                                ContextMenuOpening="IllustActions_ContextMenuOpening"
                                Width="64" Height="64" Focusable="False" BorderThickness="0"
                                HorizontalAlignment="Right" VerticalAlignment="Center"
                                HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                Style="{DynamicResource MahApps.Styles.Button.Circle}"
                                BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}">
                            <TextBlock FontSize="32" FontFamily="Segoe MDL2 Assets"
                                Text="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" 
                                Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                                HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button>
                        <Button x:Name="FollowAuthor" x:Uid="FollowAuthor" Margin="-8,0,0,0" Click="ActionIllust_Click"
                                ToolTip="Follow Author" Visibility="Collapsed" 
                                ContextMenu="{DynamicResource ActionFollowAuthor}"
                                ContextMenuOpening="IllustActions_ContextMenuOpening" 
                                Width="64" Height="64" Focusable="False" BorderThickness="0"
                                HorizontalAlignment="Right" VerticalAlignment="Center"
                                HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                Style="{DynamicResource MahApps.Styles.Button.Circle}"
                                BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}">
                            <TextBlock FontSize="32" FontFamily="Segoe MDL2 Assets"
                                Text="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" 
                                Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                                HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button>
                        <Button x:Name="IllustActions" x:Uid="IllustActions" Margin="-8,0,0,0" Click="ActionIllust_Click"
                                ToolTip="Illust Actions" Visibility="Collapsed" 
                                ContextMenu="{DynamicResource ActionIllust}"
                                ContextMenuOpening="IllustActions_ContextMenuOpening"                                
                                Width="64" Height="64" Focusable="False" BorderThickness="0"
                                HorizontalAlignment="Right" VerticalAlignment="Center"
                                HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                Style="{DynamicResource MahApps.Styles.Button.Circle}"
                                BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
                                Foreground="{DynamicResource MahApps.Brushes.Accent}">
                            <TextBlock Text="&#xE179;" FontSize="32" FontFamily="Segoe UI Symbol" FontWeight="Bold"
                                Foreground="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                                HorizontalAlignment="Center" VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5">
                                <TextBlock.RenderTransform>
                                    <ScaleTransform ScaleY="1" ScaleX="-1"/>
                                </TextBlock.RenderTransform>
                            </TextBlock>
                        </Button>
                    </StackPanel>
                </Grid>

                <!-- Illust Tag -->
                <Expander Grid.Row="2" x:Name="IllustTagExpander" x:Uid="IllustTagExpander"
                          Margin="0,4,0,0"
                          IsExpanded="True" ExpandDirection="Down"
                          Header="Tags" Visibility="Collapsed" Expanded="IllustTagExpander_Expanded">
                    <!--<interop:AirspaceDecorator x:Name="IllustTagsHost" AirspaceMode="Redirect" Background="Transparent" IsInputRedirectionEnabled="True" IsOutputRedirectionEnabled="True"/>-->
                    <DockPanel x:Name="IllustTagsHost" DockPanel.Dock="Top" LastChildFill="True" VerticalAlignment="Stretch" AllowDrop="False"/>
                </Expander>
                <StackPanel Grid.Row="2" x:Name="TagPanel" 
                            Visibility="{Binding ElementName=IllustTagExpander, Path=Visibility, Mode=OneWay, IsAsync=True}"
                            Orientation="Horizontal" Margin="0,4,0,0"
                            HorizontalAlignment="Right" VerticalAlignment="Top">
                    <Button x:Name="IllustTagPedia" x:Uid="PixivPedia" ToolTip="Query Tag in Pixiv Pedia"
                        Visibility="Visible" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionOpenPedia_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE1D3;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button x:Name="IllustTagSearchInFile" x:Uid="SearchText" ToolTip="Search Selected In Downloaded"
                        Visibility="Visible" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionSearchSelectedText_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE773;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button x:Name="IllustTagSpeech" x:Uid="Speech" ToolTip="Read Selected/All Contents"
                        Visibility="Visible" FontWeight="Normal"
                        ContextMenu="{DynamicResource MenuSpeech}"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionSpeech_Click">
                        <Button.Content>
                            <TextBlock Text="&#xEFA9;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button x:Name="IllustTagRefresh" x:Uid="TagsRefresh" ToolTip="Refresh Tags"
                        Visibility="Visible" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionRefresh_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                        <Button.ContextMenu>
                            <ContextMenu>
                                <MenuItem x:Name="ActionOpenCustomTags" Header="Open Custom Tags File" Click="ActionOpenTagsFile_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Text="&#xE1A5;" FontSize="16" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="ActionOpenCustomWildTags" Header="Open Custom Wildcard Tags File" Click="ActionOpenTagsFile_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Text="&#xE1A5;" FontSize="16" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem x:Name="ActionOpenPixivTags" Header="Open Pixiv Tags File" Click="ActionOpenTagsFile_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Text="&#xE1A5;" FontSize="16" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem x:Name="ActionOpenTagsFolder" Header="Open Tags Files Folder" Click="ActionOpenTagsFile_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Text="&#xED25;" FontSize="16" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator/>
                                <MenuItem x:Name="ActionClearTagsCache" Header="Clear Tags Translate Cache" Click="ActionRefresh_Click">
                                    <MenuItem.Icon>
                                        <TextBlock Text="&#xED62;" FontSize="16" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>
                </StackPanel>

                <!-- Illust Info -->
                <Expander Grid.Row="3" x:Name="IllustDescExpander" x:Uid="IllustDescExpander"
                          Margin="0,4,0,0"
                          IsExpanded="True" ExpandDirection="Down"
                          Header="Description" Visibility="Collapsed" Expanded="IllustDescExpander_Expanded">
                    <!--<interop:AirspaceDecorator x:Name="IllustDescHost" AirspaceMode="Clip" Background="Transparent" IsInputRedirectionEnabled="True" IsOutputRedirectionEnabled="True" />-->
                    <DockPanel x:Name="IllustDescHost" DockPanel.Dock="Top" LastChildFill="True" VerticalAlignment="Stretch" AllowDrop="False"/>
                </Expander>
                <StackPanel Grid.Row="3" x:Name="DescPanel" 
                            Visibility="{Binding ElementName=IllustDescExpander, Path=Visibility, Mode=OneWay, IsAsync=True}"
                            Orientation="Horizontal" Margin="0,4,0,0"
                            HorizontalAlignment="Right" VerticalAlignment="Top">
                    <Button x:Name="IllustDescSearchInFile" x:Uid="SearchText" ToolTip="Search Selected In Downloaded"
                        Visibility="Visible" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionSearchSelectedText_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE773;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button x:Name="IllustDescSpeech" x:Uid="Speech" ToolTip="Read Selected/All Contents"
                        Visibility="Visible" FontWeight="Normal"
                        ContextMenu="{DynamicResource MenuSpeech}"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionSpeech_Click">
                        <Button.Content>
                            <TextBlock Text="&#xEFA9;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button x:Name="IllustDescRefresh" x:Uid="DescRefresh" ToolTip="Refresh Descriptions"
                        Visibility="Visible" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionRefresh_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                </StackPanel>

                <!-- Illust Subsets -->
                <Expander Grid.Row="4" x:Name="SubIllustsExpander" x:Uid="SubIllustsExpander" 
                          Margin="0,4,0,0"
                          IsExpanded="True" ExpandDirection="Down"
                          Visibility="Collapsed" Header="Illust Sets Gallery"
                          ContextMenu="{StaticResource MenuGallaryAction}"
                          ContextMenuOpening="IllustActions_ContextMenuOpening"
                          Expanded="SubIllustsExpander_Expanded" Collapsed="SubIllustsExpander_Collapsed">
                    <Common:ImageListGrid x:Name="SubIllusts" x:Uid="SubIllusts" 
                                          Columns="5" TileWidth="128" TileHeight="128" Visibility="Visible"
                                          Focusable="True"
                                          SelectionMode="Extended" 
                                          BadgeVisibility="Visible" TitleVisibility="Collapsed"
                                          SelectionChanged="SubIllusts_SelectionChanged" 
                                          MouseDoubleClick="SubIllusts_MouseDoubleClick" 
                                          MouseWheel="SubIllusts_MouseWheel" 
                                          KeyUp="SubIllusts_KeyUp"/>

                </Expander>
                <StackPanel Grid.Row="4" x:Name="SubIllustsNavPanel" 
                            Orientation="Horizontal" Margin="0,4,0,0"
                            Visibility="{Binding ElementName=SubIllustsExpander, Path=Visibility, Mode=OneWay, IsAsync=True}"
                            HorizontalAlignment="Right" VerticalAlignment="Top" >
                    <Button 
                        x:Name="SubIllustPrevPages" x:Uid="SubIllustPrevPages"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="SubIllustPagesNav_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE112;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="SubIllustNextPages" x:Uid="SubIllustNextPages"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="SubIllustPagesNav_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE111;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="SubIllustCompare" x:Uid="ActionCompare" ToolTip="Compare Selecteor"
                        Visibility="{Binding ElementName=SubIllustRefresh, Path=Visibility}" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionCompare_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="SubIllustRefresh" x:Uid="ActionRefreshThumb" ToolTip="Refresh Thumbnails"
                        Visibility="Visible" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionRefresh_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                </StackPanel>

                <!-- Illust Related -->
                <Expander Grid.Row="5" x:Name="RelatedItemsExpander" x:Uid="RalatedItemsExpander" 
                          Margin="0,4,0,0"
                          IsExpanded="True" ExpandDirection="Down"
                          Visibility="Collapsed" Header="Related Illust Gallery"
                          ContextMenu="{StaticResource MenuGallaryAction}"
                          ContextMenuOpening="IllustActions_ContextMenuOpening"
                          MouseDown="RelatedItemsExpander_MouseDown"
                          Expanded="RelatedItemsExpander_Expanded" Collapsed="RelatedItemsExpander_Collapsed">
                    <Common:ImageListGrid x:Name="RelatedItems" x:Uid="RalatedItems"
                                          Columns="5" TileWidth="128" TileHeight="128"
                                          Focusable="True"
                                          SelectionMode="Extended"
                                          SelectionChanged="RelatedItems_SelectionChanged" 
                                          MouseDoubleClick="RelatedItems_MouseDoubleClick" 
                                          MouseWheel="RelatedItems_MouseWheel" 
                                          KeyUp="RelatedItems_KeyUp" />
                </Expander>
                <StackPanel Grid.Row="5" Orientation="Horizontal" Margin="0,4,0,0"                            
                            HorizontalAlignment="Right" VerticalAlignment="Top" >
                    <Button 
                        x:Name="RelatedPrevPage" x:Uid="RalatedPrevPage" ToolTip="Prev Page"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="RelatedPrevPage_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE112;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="RelatedNextPage" x:Uid="RalatedNextPage" ToolTip="Next Page"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="RelatedNextPage_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE111;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="RelatedNextAppend" x:Uid="RelatedNextAppend" ToolTip="Append Next Page"
                        Visibility="{Binding Visibility, ElementName=RelatedNextPage, Mode=TwoWay}" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="RelatedNextPage_Click" MouseRightButtonDown="RelatedNextAppend_MouseRightButtonDown" ToolTipOpening="RelatedNextAppend_ToolTipOpening">
                        <Button.Content>
                            <TextBlock Text="&#xEB91;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="RelatedCompare" x:Uid="ActionCompare" ToolTip="Compare Selecteor"
                        Visibility="{Binding ElementName=RelatedRefresh, Path=Visibility, Mode=TwoWay}" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionCompare_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="RelatedRefresh" x:Uid="ActionRefreshThumb" ToolTip="Refresh Thumbnails"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="ActionRefresh_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                </StackPanel>

                <!-- Illust Author Favorites -->
                <Expander Grid.Row="6" x:Name="FavoriteItemsExpander" x:Uid="FavoriteItemsExpander" 
                          Margin="0,4,0,0"
                          IsExpanded="True" ExpandDirection="Down"
                          Visibility="Collapsed" Header="Author Favorites Gallery"
                          ContextMenu="{StaticResource MenuGallaryAction}"
                          ContextMenuOpening="IllustActions_ContextMenuOpening"
                          MouseDown="FavoriteItemsExpander_MouseDown"
                          Collapsed="FavoriteItemsExpander_Collapsed" Expanded="FavoriteItemsExpander_Expanded">
                    <Common:ImageListGrid x:Name="FavoriteItems" x:Uid="FavoriteItems"
                                          Columns="5" TileWidth="128" TileHeight="128"
                                          Focusable="True"
                                          SelectionMode="Extended"
                                          SelectionChanged="FavriteIllusts_SelectionChanged" 
                                          MouseDoubleClick="FavriteIllusts_MouseDoubleClick" 
                                          MouseWheel="FavriteIllusts_MouseWheel" 
                                          KeyUp="FavriteIllusts_KeyUp"/>
                </Expander>
                <StackPanel Grid.Row="6" Orientation="Horizontal" Margin="0,4,0,0"                            
                            HorizontalAlignment="Right" VerticalAlignment="Top" >
                    <Button 
                        x:Name="FavoritePrevPage" x:Uid="FavoritePrevPage" ToolTip="Prev Page"
                        Visibility="Collapsed" FontWeight="Normal" 
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="FavoritePrevPage_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE112;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="FavoriteNextPage" x:Uid="FavoriteNextPage" ToolTip="Next Page"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="FavoriteNextPage_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE111;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="FavoriteNextAppend" x:Uid="FavoriteNextAppend" ToolTip="Append Next Page"
                        Visibility="{Binding Visibility, ElementName=FavoriteNextPage, Mode=TwoWay}" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="FavoriteNextPage_Click" ToolTipOpening="FavoriteNextAppend_ToolTipOpening">
                        <Button.Content>
                            <TextBlock Text="&#xEB91;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="FavoriteCompare" x:Uid="ActionCompare" ToolTip="Compare Selecteor"
                        Visibility="{Binding ElementName=FavoriteRefresh, Path=Visibility, Mode=TwoWay}" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0"
                        Click="ActionCompare_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE11E;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="FavoriteRefresh" x:Uid="ActionRefreshThumb" ToolTip="Refresh Thumbnails"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="ActionRefresh_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                </StackPanel>

                <!-- Illust Comments  -->
                <Expander Grid.Row="7" x:Name="CommentsExpander" x:Uid="CommentsExpander" 
                          Margin="0,4,0,0"
                          IsExpanded="True" ExpandDirection="Down"                          
                          Visibility="Collapsed" Header="Comments"
                          ContextMenu="{StaticResource MenuGallaryAction}"
                          Collapsed="CommentsExpander_Collapsed"
                          Expanded="CommentsExpander_Expanded">
                    <!--<interop:AirspaceDecorator 
                        AirspaceMode="Redirect" x:Name="IllustCommentsHostP"
                        Background="Transparent"
                        IsInputRedirectionEnabled="True"
                        IsOutputRedirectionEnabled="True">-->
                    <DockPanel x:Name="IllustCommentsHost" DockPanel.Dock="Top" LastChildFill="True" VerticalAlignment="Stretch" AllowDrop="False">
                    </DockPanel>
                    <!--</interop:AirspaceDecorator>-->
                </Expander>
                <StackPanel Grid.Row="7" x:Name="CommentsNavigator" x:Uid="CommentsNavigator"
                            Orientation="Horizontal" Margin="0,4,0,0"
                            HorizontalAlignment="Right" VerticalAlignment="Top" >
                    <Button 
                        x:Name="CommentsPrevPage" x:Uid="CommentsPrevPage" ToolTip="Prev Page"
                        Visibility="Collapsed" FontWeight="Normal" 
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="CommentsPrevPage_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE112;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="CommentsNextPage" x:Uid="CommentsNextPage" ToolTip="Next Page"
                        Visibility="Collapsed" FontWeight="Normal" 
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="CommentsNextPage_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE111;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                    <Button 
                        x:Name="btnCommentRefresh" x:Uid="ActionRefreshComment" ToolTip="Refresh Comment"
                        Visibility="Collapsed" FontWeight="Normal"
                        Style="{DynamicResource MahApps.Styles.Button.Square}" Background="Transparent"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}" BorderThickness="0"
                        Width="28" Height="20" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0"
                        Click="ActionRefresh_Click">
                        <Button.Content>
                            <TextBlock Text="&#xE149;" FontSize="16" FontFamily="Segoe MDL2 Assets" 
                               Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Button.Content>
                    </Button>
                </StackPanel>

            </Grid>
        </ScrollViewer>

        <!-- Illust Open Progress Prompt -->
        <Common:ProgressRingCloud 
            Grid.Column="0" x:Name="IllustDetailWait" Size="128" Visibility="Collapsed"
            Foreground="{DynamicResource MahApps.Brushes.Accent}" Background="Transparent" Opacity="0.75"
            ShadowColor="{DynamicResource MahApps.Colors.IdealForeground}" ShadowBlurRadius="10" ShadowDepth="1" ShadowOpacity="1"
            VerticalAlignment="Center" HorizontalAlignment="Center"/>

    </Grid>
</Page>
